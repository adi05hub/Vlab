CREATE TABLE PUBLISHER (
NAME VARCHAR 2(20) PRIMARY KEY,
ADDRESS VARCHAR 2(20),
PHONE NUMBER (10));

CREATE TABLE BOOK (
BOOK_ID INT PRIMARY KEY,
TITLE VARCHAR 2(40),
PUBLISHER_NAME VARCHAR 2(20) REFERENCES PUBLISHER (NAME) ON DELETE
CASCADE,
PUB_YEAR INT);

CREATE TABLE BOOK_AUTHORS (
BOOK_ID VARCHAR (20),
AUTHOR_NAME VARCHAR 2(20),
PRIMARY KEY (BOOK_ID, AUTHOR_NAME), FOREIGN KEY(BOOK_ID) REFERENCES
BOOK ON DELETE CASCADE);

CREATE TABLE LIBRARY_PROGRAMME (
PROGRAMME_ID VARCHAR (20) PRIMARY KEY,
PROGRAMME_NAME VARCHAR (10),
ADDRESS VARCHAR (20));

CREATE TABLE BOOK_COPIES (
BOOK_ID VARCHAR (20) REFERENCES BOOK (BOOK_ID) ON DELETE CASCADE,
PROGRAMME_ID VARCHAR (20) REFERENCES LIBRARY_PROGRAMME
(PROGRAMME_ID) ON DELETE CASCADE,
NO_OF_COPIES NUMBER (2),
PRIMARY KEY (BOOK_ID, PROGRAMME_ID));

CREATE TABLE BOOK_LENDING (
BOOK_ID VARCHAR (20),
PROGRAMME_ID VARCHAR (20),
CARD_NO VARCHAR (20),
DATE_OUT DATE,
DUE_DATE DATE,
PRIMARY KEY (PROGRAMME_ID, BOOK_ID, CARD_NO),
FOREIGN KEY (BOOK_ID) REFERENCES BOOK (BOOK_ID) ON DELETE CASCADE,
FOREIGN KEY (PROGRAMME_ID) REFERENCES LIBRARY_PROGRAMM
(PROGRAMME_ID) ON DELETE CASCADE,
CONSTRAINT CK1 CHECK (DUE_DATE > DATE_OUT));


INSERT INTO PUBLISHER VALUES ('&NAME','&ADDRESS','&PHONE')

INSERT INTO PUBLISHER VALUES ('PEARSON','LONDON',9874522224)




INSERT INTO BOOK VALUES
('&BOOK_ID','&TITLE','&PUBLISHER_NAME','&PUB_YEAR')

INSERT INTO BOOK VALUES ('B101','DBMS','PEARSON',2017)


INSERT INTO BOOK_AUTHORS VALUES ('& BOOK_ID ','&AUTHOR_NAME')

INSERT INTO BOOK_AUTHORS VALUES ('B101', 'ELMARSI');



INSERT INTO LIBRARY_PROGRAMME VALUES
('&PROGRAMME_ID','&PROGRAMME_NAME','&ADDRESS')

INSERT INTO LIBRARY_PROGRAMME VALUES
('L1','SAHYADRI','MANGALORE');


INSERT INTO BOOK_COPIES VALUES
('&BOOK_ID','&PROGRAMME_ID','&NO_OF_COPIES')

INSERT INTO BOOK_COPIES VALUES('B101','L1',99)


INSERT INTO BOOK_LENDING VALUES
('&BOOK_ID','&PROGRAMME_ID','&CARD_NO','&DATE_OUT','&DUE_DATE')

INSERT INTO BOOK_LENDING VALUES ('B101','L1','FA101','02-JAN-21','09-
JAN-21')






SQL> SELECT B.BOOK_ID, TITLE, PUBLISHER_NAME, AUTHOR_NAME,
NO_OF_COPIES
FROM BOOK B, BOOK_AUTHORS A, BOOK_COPIES BC
WHERE B.BOOK_ID = BC.BOOK_ID AND
B.BOOK_ID = A.BOOK_ID;




SQL> SELECT CARD_NO FROM BOOK_LENDING
WHERE DATE_OUT
BETWEEN '01-JAN-2023' AND '30-JUN-2023'
GROUP BY CARD_NO
HAVING COUNT(*) >= 3 ;




SELECT * FROM BOOK;



DELETE FROM BOOK WHERE BOOK_ID = &BID;

DELETE FROM BOOK WHERE BOOK_ID = &BID
DELETE FROM BOOK WHERE BOOK_ID = 'B103'




CREATE TABLE BOOK1 (
BOOK_ID VARCHAR2(20) PRIMARY KEY,
TITLE VARCHAR2(40),
PUBLISHER_NAME VARCHAR2(20) REFERENCES
PUBLISHER(NAME) ON DELETE CASCADE,
PUB_YEAR INT)
PARTITION BY RANGE(PUB_YEAR)
(PARTITION P1 VALUES LESS THAN(2001),
PARTITION P2 VALUES LESS THAN(2005),
PARTITION P3 VALUES LESS THAN (2010),
PARTITION P4 VALUES LESS THAN(MAXVALUE));



INSERT INTO BOOK1 VALUES
('&BOOK_ID','&TITLE','&PUBLISHER_NAME','&PUB_YEAR')


INSERT INTO BOOK1 VALUES ('B101','DBMS','PEARSON',2017);



SELECT * FROM BOOK1 PARTITION (P1);

SQL>SELECT * FROM BOOK1 PARTITION (P2);

SQL> SELECT * FROM BOOK1 PARTITION (P3);

SELECT * FROM BOOK1 PARTITION (P4);

SQL> CREATE VIEW AVAILABLE_BOOK AS
SELECT B.BOOK_ID, B.TITLE, SUM (BC.NO_OF_COPIES)- (SELECT COUNT(*)
FROM BOOK_LENDING BL
WHERE BL.BOOK_ID= B. BOOK_ID
GROUP BY BL.BOOK_ID) AS BOOKS_AVAILABLE
FROM BOOK B, BOOK_COPIES BC
WHERE B.BOOK_ID=BC.BOOK_ID
GROUP BY B.BOOK_ID, B.TITLE;


SQL>SELECT * FROM AVAILABLE_BOOK;




